#import "~/graphql_shared/fragments/ci_icon.fragment.graphql"
#import "~/graphql_shared/fragments/page_info.fragment.graphql"

query getPipelines(
  $fullPath: ID!
  $scope: PipelineScopeEnum
  $first: Int
  $last: Int
  $after: String = ""
  $before: String = ""
  $source: String
  $ref: String
  $username: String
  $status: PipelineStatusEnum
) {
  project(fullPath: $fullPath) {
    id
    pipelines(
      scope: $scope
      first: $first
      last: $last
      after: $after
      before: $before
      source: $source
      ref: $ref
      username: $username
      status: $status
    ) {
      nodes {
        id
        iid
        detailedStatus {
          ...CiIcon
          name
        }
        createdAt
        finishedAt
        duration
        name
        ref
        refPath
        refText
        commit {
          id
          name
          sha
          shortId
          title
          webUrl
          author {
            id
            avatarUrl
            webPath
            name
          }
        }
        user {
          id
          name
          webPath
          avatarUrl
        }
        source
        latest
        yamlErrors
        failureReason
        configSource
        stuck
        type
        path
        retryable
        cancelable
        stages {
          nodes {
            id
            name
            detailedStatus {
              ...CiIcon
              tooltip
            }
          }
        }
        mergeRequest {
          id
          iid
          webPath
          title
        }
        mergeRequestEventType
        project {
          id
          fullPath
        }
        hasManualActions
        hasScheduledActions
      }
      pageInfo {
        ...PageInfo
      }
    }
  }
}
